(function(b){b.tiny=b.tiny||{};b.tiny.circleslider={interval:false,intervaltime:3500,intervalrandom:true,placedots:true,snaptodots:false,hidedots:true,radius:140,lightbox:false,callback:null};b.fn.tinycircleslider=function(d){var c=b.extend({},b.tiny.circleslider,d);this.each(function(){b(this).data("tcs",new a(b(this),c))});return b.extend(this,{gotoSlide:function(f,e){return this.each(function(){b(this).data("tcs").gotoSlide(f,e)})},stopInterval:function(){return this.each(function(){b(this).data("tcs").stopInterval()})},startInterval:function(){return this.each(function(){b(this).data("tcs").startInterval()})}})};function a(B,h){var t=B,G=t.outerWidth(),E=t.outerHeight(),A=b(".thumb",t)[0],o=b(A).outerWidth(),n=b(A).outerHeight(),I=b(".overview",t),x=I.children(),s={},K=b("a",x),f=b(x[0]).outerWidth(true),y=null,w=null,r=10,p=0,z=0,v=this,C=[];function e(){I.append(b(x[0]).clone());x=I.children()}function H(L){w=setTimeout(function(){},(L?50:h.intervaltime))}function k(L){return L*(Math.PI/180)}function c(L){return L*180/Math.PI}function u(){var O=b(".dot",t),N=O.outerWidth(),L=O.outerHeight(),M=document.createDocumentFragment();O.remove();x=x.remove();b.each(x,function(R,T){var Q=O.clone(),P={},S=h.placedots?(R*360/x.length):parseInt(b(T).attr("data-degrees"),10);P.top=Math.round(-Math.cos(k(S))*h.radius+(E/2-L/2));P.left=Math.round(Math.sin(k(S))*h.radius+(G/2-N/2));Q.addClass(b(T).attr("data-classname"));Q.css(P);C.push({angle:S,slide:T,dot:Q});M.appendChild(Q[0])});C.sort(function(Q,P){return Q.angle-P.angle});b.each(C,function(P,Q){b(Q.dot).addClass("dot-"+(P+1));b(Q.dot).html("<span>"+(P+1)+"</span>");I.append(Q.slide)});t.append(M);s=b(".dot",t)}this.startInterval=function(L){if(h.interval){H(L)}};this.stopInterval=function(){clearTimeout(w)};function m(P,N){var O,L,M;if(P>N){O=P-N;L=-(N+(360-P))}else{O=P+(360-N);L=-(N-P)}M=O<Math.abs(L)?O:L;return[M,L,O]}function q(R){var O=9999,N=9999,Q=9999,M=0,P=0,L=0;b.each(C,function(S,T){var U=m(T.angle,R);if(Math.abs(U[0])<Math.abs(Q)){Q=U[0];L=S}if(Math.abs(U[1])<Math.abs(O)){O=U[1];M=S}if(Math.abs(U[2])<Math.abs(N)){N=U[2];P=S}});return[[L,M,P],[Q,O,N]]}this.gotoSlide=function(P,M){var Q=C[P]&&C[P].angle||0,L=m(Q,r)[0],O=Math.ceil(Math.abs(L)/10),N=(L/O)||0;l(N,Q,O,M)};function J(L){return L+((L>360)?-360:(L<0)?360:0)}function l(M,P,N,L){p+=1;var O=J(Math.round(p*M+r));if(p===N&&L){v.startInterval()}j(O,p===N);if(p<N){y=setTimeout(function(){l(M,P,N,L)},50)}else{p=0;r=P}}function F(M){var L={left:M.pageX-t.offset().left-(G/2),top:M.pageY-t.offset().top-(E/2)};r=J(c(Math.atan2(L.left,-L.top)));j(r);return false}function j(M,L){if(h.placedots){I[0].style.left=-(M/360*f*x.length)+"px"}else{closestSlidesAndAngles=q(M);closestSlides=closestSlidesAndAngles[0];closestAngles=closestSlidesAndAngles[1];I[0].style.left=-((closestSlides[1]*f)+Math.abs(closestAngles[1])*f/(Math.abs(closestAngles[1])+Math.abs(closestAngles[2])))+"px"}A.style.top=Math.round(-Math.cos(k(M))*h.radius+(E/2-n/2))+"px";A.style.left=Math.round(Math.sin(k(M))*h.radius+(G/2-o/2))+"px";if(typeof h.callback==="function"&&L){h.callback.call(B,x[z],z)}}function g(L){b(document).unbind("mousemove");document.onmouseup=A.onmouseup=null;clearTimeout(y);if(h.snaptodots){if(h.hidedots){s.stop(true,true).fadeOut("slow")}v.gotoSlide(q(r)[0][0])}v.startInterval();return false}function i(L){clearTimeout(w);b(document).mousemove(F);document.onmouseup=A.onmouseup=g;if(h.snaptodots&&h.hidedots){s.stop(true,true).fadeIn("slow")}return false}function D(){A.onmousedown=i;if(K.length>0){t.css({cursor:"pointer"}).click(function(L){if(b(L.target).hasClass("overlay")){if(h.lightbox){b(K[z]).trigger("click")}else{location.href=K[z].href}}return false})}if(h.snaptodots){t.delegate(".dot","click",function(){clearTimeout(w);if(0===p){v.gotoSlide(b(this).text()-1)}v.startInterval()})}}function d(){if(h.snaptodots){u()}e();I[0].style.width=f*x.length+"px";D();v.gotoSlide(0,h.interval)}d()}}(jQuery));